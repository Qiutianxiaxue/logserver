<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ—¥å¿—æœåŠ¡å™¨ API æ–‡æ¡£</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="/docs/swagger-ui-assets/swagger-ui.css"
    />
    <style>
      html {
        box-sizing: border-box;
        overflow: -moz-scrollbars-vertical;
        overflow-y: scroll;
      }
      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }
      body {
        margin: 0;
        background: #fafafa;
      }
    </style>
  </head>
  <body>
    <div id="swagger-ui"></div>

    <script src="/docs/swagger-ui-assets/swagger-ui-bundle.js"></script>
    <script src="/docs/swagger-ui-assets/swagger-ui-standalone-preset.js"></script>
    <script>
      window.onload = function () {
        // æ£€æŸ¥å¹¶ä¿®å¤åè®®é—®é¢˜
        function getCorrectUrl(path) {
          const protocol = window.location.protocol;
          const host = window.location.host;
          return protocol + "//" + host + path;
        }

        // æ£€æŸ¥SwaggerUIBundleæ˜¯å¦å·²åŠ è½½
        if (typeof SwaggerUIBundle === "undefined") {
          console.error("SwaggerUIBundle æœªå®šä¹‰ï¼Œå¯èƒ½æ˜¯èµ„æºåŠ è½½å¤±è´¥");
          document.getElementById("swagger-ui").innerHTML =
            '<div style="padding: 20px; color: red; font-family: Arial, sans-serif;">' +
            "<h2>ğŸš« API æ–‡æ¡£åŠ è½½å¤±è´¥</h2>" +
            "<p><strong>åŸå› ï¼š</strong> Swagger UI èµ„æºæ–‡ä»¶åŠ è½½å¤±è´¥</p>" +
            "<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>" +
            "<ol>" +
            "<li>ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„åè®®è®¿é—®ï¼ˆHTTPï¼Œä¸æ˜¯HTTPSï¼‰</li>" +
            "<li>å°è¯•è®¿é—®: <a href='http://" +
            window.location.host +
            "/docs/swagger-ui.html'>http://" +
            window.location.host +
            "/docs/swagger-ui.html</a></li>" +
            "<li>æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ</li>" +
            "<li>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯•</li>" +
            "</ol>" +
            "<p><strong>å½“å‰è®¿é—®åœ°å€ï¼š</strong> " +
            window.location.href +
            "</p>" +
            "</div>";
          return;
        }

        try {
          // ç›´æ¥åŠ è½½YAMLæ–‡ä»¶
          const ui = SwaggerUIBundle({
            url: getCorrectUrl("/docs/api-swagger.yaml"),
            dom_id: "#swagger-ui",
            deepLinking: true,
            presets: [SwaggerUIBundle.presets.apis, SwaggerUIStandalonePreset],
            plugins: [SwaggerUIBundle.plugins.DownloadUrl],
            layout: "StandaloneLayout",
            tryItOutEnabled: true,
            supportedSubmitMethods: ["get", "post", "put", "delete", "patch"],
            docExpansion: "list",
            defaultModelsExpandDepth: 2,
            defaultModelExpandDepth: 2,
            showExtensions: true,
            showCommonExtensions: true,
            onComplete: function () {
              console.log("âœ… Swagger UI å·²åŠ è½½å®Œæˆ");
              console.log(
                "ğŸ“ æ–‡æ¡£åœ°å€: " + getCorrectUrl("/docs/api-swagger.yaml")
              );
            },
            onFailure: function (error) {
              console.error("âŒ Swagger UI åŠ è½½å¤±è´¥:", error);
              // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
              document.getElementById("swagger-ui").innerHTML =
                '<div style="padding: 20px; color: red; font-family: Arial, sans-serif;">' +
                "<h2>ğŸ“„ API æ–‡æ¡£åŠ è½½å¤±è´¥</h2>" +
                "<p><strong>é”™è¯¯è¯¦æƒ…ï¼š</strong> " +
                error +
                "</p>" +
                "<p><strong>è¯·æ£€æŸ¥ï¼š</strong></p>" +
                "<ul>" +
                "<li>æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ</li>" +
                "<li>api-swagger.yaml æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li>" +
                "<li>ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸</li>" +
                "<li>æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰æ›´å¤šé”™è¯¯ä¿¡æ¯</li>" +
                "</ul>" +
                "<p><strong>å°è¯•ç›´æ¥è®¿é—®ï¼š</strong> <a href='" +
                getCorrectUrl("/docs/api-swagger.yaml") +
                "' target='_blank'>" +
                getCorrectUrl("/docs/api-swagger.yaml") +
                "</a></p>" +
                "</div>";
            },
          });
        } catch (error) {
          console.error("âŒ åˆå§‹åŒ– Swagger UI æ—¶å‘ç”Ÿé”™è¯¯:", error);
          document.getElementById("swagger-ui").innerHTML =
            '<div style="padding: 20px; color: red; font-family: Arial, sans-serif;">' +
            "<h2>ğŸš¨ åˆå§‹åŒ–é”™è¯¯</h2>" +
            "<p>Swagger UI åˆå§‹åŒ–å¤±è´¥: " +
            error.message +
            "</p>" +
            "<p>è¯·åˆ·æ–°é¡µé¢é‡è¯•ï¼Œæˆ–è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚</p>" +
            "</div>";
        }
      };
    </script>
  </body>
</html>
